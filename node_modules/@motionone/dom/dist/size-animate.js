class t{setAnimation(t){this.animation=t,null==t||t.finished.then((()=>this.clearAnimation())).catch((()=>{}))}clearAnimation(){this.animation=this.generator=void 0}}const e=new WeakMap;function n(t){return e.has(t)||e.set(t,{transforms:[],values:new Map}),e.get(t)}const i={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},a=t=>"number"==typeof t,s=t=>"object"==typeof t&&Boolean(t.createAnimation),r=t=>Array.isArray(t)&&!a(t[0]),o=(t,e,n)=>-n*t+n*e+t,l=()=>{},c=t=>t,u=(t,e,n)=>e-t==0?1:(n-t)/(e-t);function h(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const a=u(0,e,i);t.push(o(n,1,a))}}const f=t=>1e3*t,d=["","X","Y","Z"],m={x:"translateX",y:"translateY",z:"translateZ"},p={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:t=>t+"deg"},y={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:t=>t+"px"},rotate:p,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:c},skew:p},g=new Map,v=t=>`--motion-${t}`,T=["x","y","z"];["translate","scale","rotate","skew"].forEach((t=>{d.forEach((e=>{T.push(t+e),g.set(v(t+e),y[t])}))}));const w=(t,e)=>T.indexOf(t)-T.indexOf(e),S=new Set(T),A=t=>S.has(t),b=t=>t.sort(w).reduce(x,"").trim(),x=(t,e)=>`${t} ${e}(var(${v(e)}))`,k=t=>t.startsWith("--"),O=new Set;const M=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t;function D(t,e,n,i){if(t===e&&n===i)return c;const a=e=>function(t,e,n,i,a){let s,r,o=0;do{r=e+(n-e)/2,s=M(r,i,a)-t,s>0?n=r:e=r}while(Math.abs(s)>1e-7&&++o<12);return r}(e,0,1,t,n);return t=>0===t||1===t?t:M(a(t),e,i)}const P=(t,e="end")=>n=>{const i=(n="end"===e?Math.min(n,.999):Math.max(n,.001))*t,a="end"===e?Math.floor(i):Math.ceil(i);return s=0,r=1,o=a/t,Math.min(Math.max(o,s),r);var s,r,o},R={ease:D(.25,.1,.25,1),"ease-in":D(.42,0,1,1),"ease-in-out":D(.42,0,.58,1),"ease-out":D(0,0,.58,1)},j=/\((.*?)\)/;function E(t){if("function"==typeof t)return t;if(Array.isArray(t))return D(...t);if(R[t])return R[t];if(t.startsWith("steps")){const e=j.exec(t);if(e){const t=e[1].split(",");return P(parseFloat(t[0]),t[1].trim())}}return c}function V(t,e=function(t){const e=[0];return h(e,t-1),e}(t.length),n=c){const i=t.length,a=i-e.length;return a>0&&h(e,a),a=>{let s=0;for(;s<i-2&&!(a<e[s+1]);s++);let l=(c=u(e[s],e[s+1],a),Math.min(1,Math.max(c,0)));var c;const h=function(t,e){return r(t)?t[((t,e,n)=>{const i=e-t;return((n-t)%i+i)%i+t})(0,t.length,e)]:t}(n,s);return l=h(l),o(t[s],t[s+1],l)}}class ${constructor(t,e=[0,1],{easing:n=i.easing,duration:a=i.duration,delay:o=i.delay,endDelay:l=i.endDelay,repeat:u=i.repeat,offset:h,direction:f="normal"}={}){if(this.startTime=null,this.rate=1,this.t=0,this.cancelTimestamp=null,this.playState="idle",this.finished=new Promise(((t,e)=>{this.resolve=t,this.reject=e})),s(n)){const t=n.createAnimation(e,(()=>"0"),!0);n=t.easing,void 0!==t.keyframes&&(e=t.keyframes),void 0!==t.duration&&(a=t.duration)}const d=r(n)?c:E(n),m=a*(u+1),p=V(e,h,r(n)?n.map(E):c);this.tick=e=>{var n;this.pauseTime&&(e=this.pauseTime);let i=(e-this.startTime)*this.rate;this.t=i,i/=1e3,i=Math.max(i-o,0),"finished"===this.playState&&(i=m);const s=i/a;let r=Math.floor(s),c=s%1;!c&&s>=1&&(c=1),1===c&&r--;const u=r%2;("reverse"===f||"alternate"===f&&u||"alternate-reverse"===f&&!u)&&(c=1-c);const h=i>=m?1:Math.min(c,1),y=p(d(h));t(y);"finished"===this.playState||i>=m+l?(this.playState="finished",null===(n=this.resolve)||void 0===n||n.call(this,y)):"idle"!==this.playState&&(this.frameRequestId=requestAnimationFrame(this.tick))},this.play()}play(){var t;const e=performance.now();this.playState="running",this.pauseTime?this.startTime=e-(this.pauseTime-(null!==(t=this.startTime)&&void 0!==t?t:0)):this.startTime||(this.startTime=e),this.cancelTimestamp=this.startTime,this.pauseTime=void 0,requestAnimationFrame(this.tick)}pause(){this.playState="paused",this.pauseTime=performance.now()}finish(){this.playState="finished",this.tick(0)}stop(){var t;this.playState="idle",void 0!==this.frameRequestId&&cancelAnimationFrame(this.frameRequestId),null===(t=this.reject)||void 0===t||t.call(this,!1)}cancel(){this.stop(),this.tick(this.cancelTimestamp)}reverse(){this.rate*=-1}commitStyles(){}get currentTime(){return this.t}set currentTime(t){this.pauseTime||0===this.rate?this.pauseTime=t:this.startTime=performance.now()-t/this.rate}get playbackRate(){return this.rate}set playbackRate(t){this.rate=t}}const q=t=>(t=>Array.isArray(t)&&a(t[0]))(t)?F(t):t,F=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`,U=t=>document.createElement("div").animate(t,{duration:.001}),C={cssRegisterProperty:()=>"undefined"!=typeof CSS&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{U({opacity:[1]})}catch(t){return!1}return!0},finished:()=>Boolean(U({opacity:[0,1]}).finished)},_={},I={};for(const t in C)I[t]=()=>(void 0===_[t]&&(_[t]=C[t]()),_[t]);function W(t){return m[t]&&(t=m[t]),A(t)?v(t):t}const z=(t,e)=>{e=W(e);let n=k(e)?t.style.getPropertyValue(e):getComputedStyle(t)[e];if(!n&&0!==n){const t=g.get(e);t&&(n=t.initialValue)}return n},B=(t,e,n)=>{e=W(e),k(e)?t.style.setProperty(e,n):t.style[e]=n};function K(t,e=!0){if(t&&"finished"!==t.playState)try{t.stop?t.stop():(e&&t.commitStyles(),t.cancel())}catch(t){}}function X(e,o,c,u={}){const h=window.__MOTION_DEV_TOOLS_RECORD,d=!1!==u.record&&h;let p,{duration:y=i.duration,delay:v=i.delay,endDelay:T=i.endDelay,repeat:w=i.repeat,easing:S=i.easing,direction:x,offset:M,allowWebkitAcceleration:D=!1}=u;const P=n(e);let R=I.waapi();const j=A(o);j&&((t,e)=>{m[e]&&(e=m[e]);const{transforms:i}=n(t);var a,s;s=e,-1===(a=i).indexOf(s)&&a.push(s),t.style.transform=b(i)})(e,o);const E=W(o),V=function(e,n){return e.has(n)||e.set(n,new t),e.get(n)}(P.values,E),F=g.get(E);return K(V.animation,!(s(S)&&V.generator)&&!1!==u.record),()=>{const t=()=>{var t,n;return null!==(n=null!==(t=z(e,E))&&void 0!==t?t:null==F?void 0:F.initialValue)&&void 0!==n?n:0};let n=function(t,e){for(let n=0;n<t.length;n++)null===t[n]&&(t[n]=n?t[n-1]:e());return t}((t=>Array.isArray(t)?t:[t])(c),t);if(s(S)){const e=S.createAnimation(n,t,j,E,V);S=e.easing,void 0!==e.keyframes&&(n=e.keyframes),void 0!==e.duration&&(y=e.duration)}if(k(E)&&(I.cssRegisterProperty()?function(t){if(!O.has(t)){O.add(t);try{const{syntax:e,initialValue:n}=g.has(t)?g.get(t):{};CSS.registerProperty({name:t,inherits:!1,syntax:e,initialValue:n})}catch(t){}}}(E):R=!1),R){F&&(n=n.map((t=>a(t)?F.toDefaultUnit(t):t))),1!==n.length||I.partialKeyframes()&&!d||n.unshift(t());const i={delay:f(v),duration:f(y),endDelay:f(T),easing:r(S)?void 0:q(S),direction:x,iterations:w+1,fill:"both"};p=e.animate({[E]:n,offset:M,easing:r(S)?S.map(q):void 0},i),p.finished||(p.finished=new Promise(((t,e)=>{p.onfinish=t,p.oncancel=e})));const s=n[n.length-1];p.finished.then((()=>{B(e,E,s),p.cancel()})).catch(l),D||(p.playbackRate=1.000001)}else if(j){n=n.map((t=>"string"==typeof t?parseFloat(t):t)),1===n.length&&n.unshift(parseFloat(t()));p=new $((t=>{F&&(t=F.toDefaultUnit(t)),B(e,E,t)}),n,Object.assign(Object.assign({},u),{duration:y,easing:S}))}else{const t=n[n.length-1];B(e,E,F&&a(t)?F.toDefaultUnit(t):t)}return d&&h(e,o,n,{duration:y,delay:v,easing:S,repeat:w,offset:M},"motion-one"),V.setAnimation(p),p}}const Y=(t,e)=>t[e]?Object.assign(Object.assign({},t),t[e]):Object.assign({},t);const Z=t=>t(),L={get:(t,e)=>{const n=t.animations[0];switch(e){case"duration":return t.duration;case"currentTime":let i=(null==n?void 0:n[e])||0;return i?i/1e3:0;case"playbackRate":case"playState":return null==n?void 0:n[e];case"finished":return t.finished||(t.finished=Promise.all(t.animations.map(N)).catch(l)),t.finished;case"stop":return()=>t.animations.forEach((t=>K(t)));default:return void 0===(null==n?void 0:n[e])?void 0:()=>t.animations.forEach((t=>t[e]()))}},set:(t,e,n)=>{switch(e){case"currentTime":n=f(n);case"currentTime":case"playbackRate":for(let i=0;i<t.animations.length;i++)t.animations[i][e]=n;return!0}return!1}},N=t=>t.finished;function G(t,e,n){return"function"==typeof t?t(e,n):t}function H(t,e,n={}){const a=(t=function(t,e){var n;return"string"==typeof t?e?(null!==(n=e[t])&&void 0!==n||(e[t]=document.querySelectorAll(t)),t=e[t]):t=document.querySelectorAll(t):t instanceof Element&&(t=[t]),Array.from(t||[])}(t)).length,s=[];for(let i=0;i<a;i++){const r=t[i];for(const t in e){const o=Y(n,t);o.delay=G(o.delay,i,a);const l=X(r,t,e[t],o);s.push(l)}}return((t,e=i.duration)=>new Proxy({animations:t.map(Z).filter(Boolean),duration:e},L))(s,n.duration)}export{H as animate};
